class oaeservice::deps::pp {
  include oaeservice::deps::common

  $phantomjs_version = hiera('phantomjs_version')
  $phantomjs_checksum = hiera('phantomjs_checksum')

  # Necessary packages for phantomjs and other PP functionality
  $pp_packages = [
    'libreoffice',
    'pdftk',
    'chrpath',
    'libfontconfig1-dev',
    'fonts-sil-scheherazade',
    'xfonts-intl-arabic',
    'fonts-takao-gothic',
    'fonts-takao-mincho',
    'fonts-takao-pgothic',
    'fonts-ipafont-gothic',
    'fonts-ipafont-mincho',
    'fonts-mikachan',
    'fonts-aoyagi-kouzan-t',
    'fonts-aoyagi-soseki',
    'fonts-hanazono',
    'fonts-horai-umefont',
    'fonts-ipaexfont',
    'fonts-ipaexfont-gothic',
    'fonts-ipaexfont-mincho',
    'fonts-ipafont',
    'fonts-ipamj-mincho',
    'xfonts-intl-japanese',
    'xfonts-intl-japanese-big',
    'fonts-arphic-bkai00mp',
    'fonts-arphic-bsmi00lp',
    'fonts-arphic-gbsn00lp',
    'fonts-arphic-gkai00mp',
    'fonts-arphic-ukai',
    'fonts-arphic-uming',
    'xfonts-intl-chinese',
    'xfonts-intl-chinese-big',
    'fonts-nanum',
    'fonts-nanum-coding',
    'fonts-nanum-extra',
    'fonts-unfonts-core',
    'fonts-baekmuk',
    'fonts-nanum-eco',
    'fonts-nanum-gothic-light',
    'fonts-unfonts-extra',
    'xfonts-baekmuk',
    'fonts-tibetan-machine',
    'fonts-thai-tlwg',
    'xfonts-thai',
    'fonts-dzongkha',
    'fonts-farsiweb',
    'fonts-khmeros',
    'fonts-khmeros-core',
    'fonts-lao',
    'fonts-manchufont',
    'fonts-nafees',
    'fonts-sil-abyssinica',
    'fonts-sil-ezra',
    'fonts-sil-padauk',
    'fonts-bpg-georgian',
    'fonts-cwtex-docs',
    'fonts-cwtex-fs',
    'fonts-cwtex-heib',
    'fonts-cwtex-kai',
    'fonts-cwtex-ming',
    'fonts-cwtex-yen',
    'fonts-evertype-conakry',
    'fonts-freefarsi',
    'fonts-gubbi',
    'fonts-kanjistrokeorders',
    'fonts-komatuna',
    'fonts-lg-aboriginal',
    'fonts-lklug-sinhala',
    'fonts-mph-2b-damase',
    'fonts-navilu',
    'fonts-pagul',
    'fonts-senamirmir-washra',
    'fonts-sil-charis',
    'fonts-sil-dai-banna',
    'fonts-sil-nuosusil',
    'fonts-sil-sophia-nubian',
    'fonts-sil-zaghawa-beria',
    'fonts-sipa-arundina',
    'fonts-ukij-uyghur',
    'fonts-unikurdweb',
    'fonts-uralic',
    'xfonts-bitmap-mule',
    'xfonts-a12k12',
    'xfonts-efont-unicode',
    'xfonts-efont-unicode-ib',
    'xfonts-intl-asian',
    'xfonts-intl-european',
    'xfonts-jmk',
    'xfonts-marumoji',
    'xfonts-wqy',
    'xfonts-cyrillic',
    'ttf-ancient-fonts',
    'ttf-bengali-fonts',
    'ttf-bpg-georgian-fonts',
    'ttf-devanagari-fonts',
    'ttf-gujarati-fonts',
    'ttf-indic-fonts',
    'ttf-indic-fonts-core',
    'ttf-kannada-fonts',
    'ttf-malayalam-fonts',
    'ttf-oriya-fonts',
    'ttf-punjabi-fonts',
    'ttf-tamil-fonts',
    'ttf-telugu-fonts',
    'ttf-paktype',
    'ttf-tagbanwa'
  ]
  package { $pp_packages: ensure => installed }

  archive { 'phantomjs':
    ensure        => present,
    url           => "https://phantomjs.googlecode.com/files/phantomjs-${phantomjs_version}-linux-x86_64.tar.bz2",
    digest_string => $phantomjs_checksum,
    target        => '/opt',
    extension     => 'tar.bz2',
    src_target    => '/opt',
    require       => [ Package[$pp_packages], Class['::oaeservice::deps::common'] ]
  }

}
